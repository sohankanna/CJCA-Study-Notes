# 13 - Windows Information Gathering


## 1. Initial Network Scan (`nmap`)

We begin with a comprehensive `nmap` scan to map the target's attack surface.

*   **Command:**
    ```shell
    sudo nmap -p- -sV -sC 10.129.12.20 -T5 -Pn
    ```
    *   `-p-`: Scan all TCP ports.
    *   `-sV`: Service/Version detection.
    *   `-sC`: Run default scripts.
    *   `-T5`: Use aggressive timing (use with caution).
    *   `-Pn`: Skip host discovery (treat the host as online).

### Nmap Scan Results - Key Findings
The scan confirms the host is a **Windows Server 2019** machine named `WIN01` and reveals several key services.

| Port | Service | Nmap Finding | Initial Analysis |
| :--- | :--- | :--- | :--- |
| **22/tcp** | **SSH** | `OpenSSH for_Windows_9.5` | Secure remote access. |
| **135/tcp** | **MSRPC**| `Microsoft Windows RPC` | Standard Windows service. |
| **139/tcp**| **NetBIOS**| `Microsoft Windows netbios-ssn`| Legacy file/printer sharing service. |
| **445/tcp** | **SMB** | `Windows Server 2019 Standard`| The primary file sharing service. Nmap scripts show **message signing is disabled** (dangerous) and **SMBv1 is enabled** (highly unusual and a major red flag). |
| **3000/tcp**| **HTTP** | `Golang net/http server`, Title: `Cube Case Gitea` | A web server is running a **Gitea** instance (a self-hosted Git service). This is a high-value target. |
| **3389/tcp**| **RDP** | `Microsoft Terminal Services` | Graphical remote access is enabled. A target for credential-based attacks. |
| **5985/tcp**| **HTTP** | `Microsoft HTTPAPI httpd 2.0` | **WinRM** (Windows Remote Management) is enabled, allowing PowerShell remoting. |

---

## 2. Enumerating Specific Services

### a) Gitea Web Service (Port 3000)
By browsing to `http://10.129.12.20:3000`, we can gather more information.

*   **What it is:** Gitea is a self-hosted alternative to GitHub, used by development teams to store and manage source code.
*   **Critical Finding:** The web page footer reveals the exact version: **Gitea version 1.12.4**.
*   **Security Relevance:** An **outdated software version** is a significant potential vulnerability. The next step is to research this specific version for any publicly disclosed exploits (CVEs). Code repositories can also contain sensitive information like API keys or credentials if they are misconfigured to be publicly accessible.

### b) SMB Service (Port 445)
We can use a specialized SMB enumeration tool like `crackmapexec` to investigate the SMB service more deeply.

*   **Check for SMBv1:**
    ```shell
    crackmapexec smb 10.129.12.20
    ```
    *   **Result:** Confirms that `SMBv1` is enabled, which is a major security risk as it's associated with vulnerabilities like EternalBlue.

*   **Test for Anonymous (NULL) Session:**
    ```shell
    crackmapexec smb 10.129.12.20 -u '' -p '' --users
    ```
    *   **Result:** A NULL session is possible, but we are denied permission to list users, indicating some level of protection.

*   **Test Guest Access and Enumerate Shares:**
    ```shell
    crackmapexec smb 10.129.12.20 -u guest -p '' --shares
    ```
    *   **Result:** The `guest` account is enabled and has permission to list the available shares.
    *   **Critical Finding:** A custom share named `Devs` is discovered, in addition to the standard administrative shares (`ADMIN$`, `C$`, `IPC$`). This custom share is a high-priority target for further enumeration to see if it contains readable files.

---

## 3. Summary of Findings for the Windows Target

Our information gathering has provided a clear picture of the target and several potential "low-hanging fruits."

| Component | Information Gathered |
| :--- | :--- |
| **OS** | Windows Server 2019 Standard (`WIN01`) |
| **Key Services**| SMB, RDP, SSH, WinRM, Gitea |
| **Gitea (3000)** | Running an **outdated version (1.12.4)**. This is a primary attack vector. |
| **SMB (445)** | **SMBv1 is enabled** (very risky). `guest` access is enabled and revealed a custom share named `Devs`. |
| **Remote Access**| RDP, SSH, and WinRM are all enabled, providing multiple potential entry points if credentials are obtained. |

**Next Steps:** The most promising avenues for exploitation are researching CVEs for Gitea v1.12.4 and further enumerating the contents of the `Devs` SMB share using the `guest` account.
