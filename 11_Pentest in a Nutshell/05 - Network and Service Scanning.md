# 05 - Network and Service Scanning


## 1. The Goal of Network Scanning

The primary objective of network scanning is to **map the target's attack surface**. By the end of this phase, a penetration tester should be able to answer key questions:
*   Which hosts are online within the defined scope?
*   Which network ports are open on those hosts?
*   What services (and their versions) are running on those open ports?
*   What operating system is the host likely running?

This information is critical for prioritizing targets and planning the subsequent vulnerability analysis and exploitation phases.

---

## 2. `nmap` - The Essential Scanning Tool

**Nmap (Network Mapper)** is the undisputed industry-standard tool for network discovery and security auditing. It is an extremely powerful and versatile open-source utility.

### A Practical Scanning Command
A good initial scan aims to be thorough without being overly aggressive. The following command is a great starting point for an internal network assessment.

```shell
nmap -sV -p- 10.129.12.0/24 -oA network-scan
```
**Breaking down the command:**
*   **`nmap`**: The command to run the tool.
*   **`-sV`**: Enables **service and version detection**. Nmap will probe open ports to determine the specific software and version running (e.g., "Apache httpd 2.4.41"). This is crucial for finding version-specific public exploits.
*   **`-p-`**: Tells Nmap to scan **all 65,535 TCP ports**. By default, Nmap only scans the top 1,000 most common ports. This flag ensures no unusual or hidden services are missed.
*   **`10.129.12.0/24`**: The **target scope**. In this case, it's an entire `/24` subnet.
*   **`-oA network-scan`**: **O**utputs the scan results in **A**ll major formats (`.nmap`, `.gnmap`, and `.xml`) using the base filename `network-scan`. Saving results is a critical best practice.

---

## 3. Interpreting Scan Results

The output from `nmap` provides a detailed list of active hosts and their services. This is where a tester's analysis begins.

### Example Host 1: `10.129.12.10` (Likely a Linux Server)
*   **`21/tcp open ftp ProFTPD`**: An FTP server is running. This is a high-priority target for checking for anonymous login or weak credentials.
*   **`22/tcp open ssh OpenSSH 8.9p1 Ubuntu`**: An SSH server, with the version clearly identified.
*   **`80/tcp open http nginx 1.18.0`**: An Nginx web server. The web application hosted here is a primary target.
*   **`443/tcp open ssl/http Apache httpd 2.4.52`**: An Apache web server running a secure site.

### Example Host 2: `10.129.12.20` (Clearly a Windows Server)
*   **`139/tcp open netbios-ssn` & `445/tcp open microsoft-ds`**: These ports indicate that **SMB** is running. SMB is a critical service and a classic target for exploits (like EternalBlue) and credential-based attacks.
*   **`3389/tcp open ms-wbt-server`**: **RDP (Remote Desktop Protocol)** is open. This is a primary target for brute-force or password spraying attacks if valid usernames are known.
*   **`5985/tcp open http`**: This port is used for **WinRM (Windows Remote Management)** over HTTP, indicating PowerShell remoting might be enabled.

---

## 4. Leveraging the Results: Finding "Low-Hanging Fruit"

The scan results are not the end of the test; they are the beginning. The next steps involve using this information to find easy-to-exploit vulnerabilities.

*   **Vulnerability Scanning:** Use a dedicated scanner like **Nessus** or **OpenVAS** against the discovered hosts and ports to automatically check for known CVEs based on the service versions found by Nmap.
*   **Credential Testing:** Attempt default or weak password attacks against services like FTP, SSH, and RDP.
*   **Web Application Analysis:** Begin a detailed manual assessment of the web applications running on ports 80, 443, 3000, etc.
*   **Exploit Testing:** Use a framework like **Metasploit** to search for and launch exploits against any vulnerable services that were identified.

---

## 5. The Importance of Note-Taking

Meticulous note-taking is an essential skill for a penetration tester.
*   **Document Everything:** Record every command you run, its exact syntax, the time it was run, and its full output.
*   **Log Your Findings:** When you discover something interesting (a potential vulnerability, an unusual port), document what you found, why it's interesting, and your plan for investigating it further.
*   **Facilitate Reporting:** Good notes are the foundation of a good final report. They provide the evidence, reproduction steps, and context needed to write a clear and actionable report for the client.
