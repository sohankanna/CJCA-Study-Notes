# 11 - Linux Privilege Escalation

## 1. Recap of Current Status

Our vulnerability assessment identified a clear and direct path to privilege escalation. Let's review our key findings for the user `john`:
*   **Sudo Privileges:** The user `john` is a member of the `sudo` group.
*   **Password:** We have the password `SuperSecurePass123` for the user `john`.
*   **Specific Sudo Rule:** `john` can run `/usr/bin/nano` as the `root` user **without a password** (`NOPASSWD`).

---

## 2. The Path to Root: Exploiting Sudo Privileges

We have two distinct methods to escalate privileges to `root` based on our findings.

### Method 1: Sudo Abuse via `nano` (The `NOPASSWD` Vector)
This method is ideal because it does not require us to know the user's password. It exploits the specific, misconfigured `sudo` rule.

*   **The Vulnerability:** The `sudo -l` command confirms the rule:
    ```
    User john may run the following commands on ubuntu:
        (root) NOPASSWD: /usr/bin/nano
    ```
*   **The Technique (GTFOBins):** Many standard Linux programs, including text editors like `nano`, have features that allow a user to execute system commands from within the application. If such a program is run as `root`, any command it executes will also run as `root`. The **GTFOBins** project is a curated list of these "breakout" techniques.
*   **The Exploitation Steps:**
    1.  Execute `nano` with `sudo` to open it as the `root` user. The filename (`privesc`) is arbitrary.
        ```shell
        john@ubuntu:~$ sudo /usr/bin/nano privesc
        ```
    2.  Inside `nano`, press **`Ctrl + R`** (Read File), then **`Ctrl + X`** (Execute Command).
    3.  At the "Command to execute" prompt at the bottom of the screen, type the following command to spawn a shell:
        ```
        reset; /bin/bash
        ```
    4.  The `nano` interface will be replaced by a new shell prompt.
*   **The Result:** We can run the `id` command to confirm our identity.
    ```shell
    # id
    uid=0(root) gid=0(root) groups=0(root)
    ```
    We have successfully escalated privileges to `root`.

### Method 2: Direct Escalation with `sudo su` (The Password Vector)
Since we discovered the user's password (`SuperSecurePass123`), we can use the most direct method to become root.

*   **The Vulnerability:** The `sudo -l` command also shows the general rule `(ALL : ALL) ALL`, which means `john` can run any command as any user, provided they enter their password.
*   **The Command:** `sudo su` is a command that uses `sudo` to run the `su` (switch user) command. With no user specified, `su` defaults to switching to `root`.
*   **The Exploitation Steps:**
    1.  Execute the `sudo su` command.
        ```shell
        john@ubuntu:~$ sudo su
        ```
    2.  When prompted, enter the password for `john`: `SuperSecurePass123`.
*   **The Result:** The shell prompt changes to `#`, and the `id` command confirms we are now the `root` user.
    ```shell
    root@ubuntu:/home/john# id
    uid=0(root) gid=0(root) groups=0(root)
    ```

---

## 3. Post-Exploitation as Root

With `root` access, the post-exploitation phase is not over. The next steps would be:
1.  **Document:** Meticulously document both successful privilege escalation paths for the final report.
2.  **Deeper Enumeration:** Re-run enumeration scripts (like LinPEAS) **as root**. This will uncover sensitive files, configurations, and processes that were previously inaccessible.
3.  **Persistence:** Establish a stealthy method to maintain root access to the machine.
4.  **Pivoting:** Use the now fully-compromised machine as a launchpad to perform lateral movement and attack other systems on the network.
