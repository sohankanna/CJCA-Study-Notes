# 10 - Linux Vulnerability Assessment


## 1. Analyzing the LinPEAS Output

After retrieving the `linpeas_results.txt` file, we can analyze it section by section to build a clear picture of the system's security posture.

### a) Basic System Information
*   **OS:** Ubuntu 22.04.4 LTS ("jammy")
*   **Kernel:** `5.15.0-135-generic`
*   **Current User:** `john` (uid=1000)
*   **Groups:** `john`, `sudo`
*   **Key Insight:** The user `john` is in the `sudo` group, which is a major finding and a primary avenue for privilege escalation. The specific OS and kernel version are crucial for researching potential kernel exploits.

### b) Linux Exploit Suggester Results
LinPEAS includes a script that suggests potential kernel exploits based on the OS and kernel version.
*   **Suggestions:** `CVE-2022-0847 (DirtyPipe)` and `CVE-2021-4034 (PwnKit)`.
*   **Analysis:** The script notes that these are "less probable" and the "Tags" section does not explicitly list Ubuntu 22.04. This strongly suggests that the system is likely **patched** against these specific, well-known kernel exploits. We should not waste time on them and should look for other vectors.

### c) User Information and `sudo` Privileges
This is often the most fruitful section for privilege escalation.
*   **`sudo -l` Results:** LinPEAS runs `sudo -l` to check the user's `sudo` permissions. The output reveals two critical rules for the user `john`:
    1.  `(ALL) NOPASSWD: /usr/bin/nano`
    2.  `(ALL : ALL) ALL`
*   **Analysis:**
    *   The first rule is a **classic misconfiguration**. It allows `john` to run the `nano` text editor **as the `root` user without needing to provide a password**.
    *   The second rule indicates that `john` can run **any command as any user** if they provide their own password.
*   **Critical Finding:** The `NOPASSWD` rule for `nano` is a direct and easy path to a root shell.

### d) Other Interesting Findings
*   **User/Group Anomaly:** The `www-data` user (the web server's user) is a member of the `john` group. This is an unusual configuration that grants the web server process read access to many of `john`'s files.
*   **Installed Software:** A wide range of useful tools are installed, such as `curl`, `wget`, `python`, and `perl`. This confirms we have many options for transferring files or executing reverse shells if needed.
*   **Security Protections:** `AppArmor` is present but unconfined for our user. `SELinux` is not active. **ASLR** (Address Space Layout Randomization) is enabled, which is a standard modern security protection.

---

## 2. Summary of Actionable Findings

Based on the LinPEAS analysis, we have a clear and direct path to full system compromise.

| Finding | Description | Security Impact |
| :--- | :--- | :--- |
| **Sudo `NOPASSWD` for `nano`**| The user `john` can run `/usr/bin/nano` as the `root` user without a password. | **Critical.** This is a direct privilege escalation vector. Many text editors, including `nano`, can be used to read/write any file on the system or even spawn a shell. |
| **`www-data` in `john` group**| The web server process has read access to the user `john`'s home directory. | **High.** This explains how the sensitive files (`.bash_history`, `id_rsa`) were accessible via the FTP server (which runs as `www-data`), as this was likely `john`'s home directory. |
| **Kernel Version** | Ubuntu 22.04.4 LTS is a modern, patched version. | **Low.** Publicly known, easy kernel exploits like DirtyPipe and PwnKit are unlikely to work. This vector is not worth pursuing initially. |

**Conclusion:** The vulnerability assessment has successfully moved us from the broad findings of a network scan to a specific, high-confidence exploitation plan. The primary target is the misconfigured `sudo` rule for `nano`.
