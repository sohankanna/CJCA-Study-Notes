# 07 - Linux Information gathering



## 1. Enumerating the FTP Service (Port 21)

Our initial `nmap` scan revealed that **Anonymous FTP login** is allowed. We can connect to the service using the built-in `ftp` client.

*   **Connection Command:**
    ```shell
    ftp 10.129.12.10
    ```
*   **Credentials:**
    *   **Username:** `anonymous`
    *   **Password:** `anonymous` (or any email address)

### Key Findings from FTP
Once connected, we can enumerate the file system.

1.  **Initial Directory Listing (`ls`):**
    *   Reveals a file: `WordPress_Blog_Setup_Update.txt`.
    *   The file is owned by the user `john`.

2.  **Listing Hidden Files (`ls -al`):**
    *   Reveals a full set of user configuration files (`.bashrc`, `.profile`, etc.), confirming this is the **home directory for the user `john`**.
    *   Two critical files are discovered: `.bash_history` and an `.ssh` directory.

3.  **Downloading Sensitive Files (`get`):**
    We download the interesting files for offline analysis.
    ```ftp
    get WordPress_Blog_Setup_Update.txt
    get .bash_history
    cd .ssh
    get id_rsa
    exit
    ```

### Analysis of Downloaded Files

*   **`WordPress_Blog_Setup_Update.txt`:** An internal memo from "John Doe" of the "Development Team."
    *   **Intel:** Confirms the FTP server was temporary, the WordPress installation is incomplete, and provides a potential name for social engineering.

*   **`.bash_history`:** The user's command history.
    *   **Intel:** Reveals sensitive commands and potential credentials.
    *   **Critical Finding:** The line `echo "john:SuperSecurePass123" | sudo chpasswd` exposes a **potential password** for the user `john`.

*   **`id_rsa`:** The user's **SSH private key**.
    *   **Intel:** A quick inspection (`cat id_rsa`) shows it is **not encrypted** with a passphrase.
    *   **Critical Finding:** An unencrypted private key is a direct way to gain access to the system if we can log in as the user `john`.

---

## 2. Enumerating the WordPress Service (Port 443)

Our initial scan identified a **WordPress 6.7.2** installation. We can use a specialized scanner called `wpscan` to enumerate it for vulnerabilities.

*   **`wpscan` Command:**
    ```shell
    wpscan --url https://10.129.12.10 --disable-tls-checks -e p -t 100
    ```
    *   `--url`: The target URL.
    *   `--disable-tls-checks`: To ignore the self-signed certificate.
    *   `-e p`: **e**numerate vulnerable **p**lugins.
    *   `-t 100`: Use 100 threads to speed up the scan.

### Key Findings from `wpscan`
*   **WordPress Version:** Confirmed as `6.7.2`.
*   **Theme:** `twentytwentyfive` v1.0 (outdated).
*   **Plugin:** `hash-form` v1.1.0 (outdated).

### Vulnerability Analysis with Metasploit
We can use the `msfconsole` to search for public exploits related to our findings.

*   **Search Command:**
    ```
    msf6 > search wordpress hash form
    ```
*   **Critical Finding:** Metasploit finds an **excellent-rank Remote Code Execution (RCE)** exploit (`exploit/multi/http/wp_hash_form_rce`) for the **Hash Form plugin, version 1.1.0 and below (CVE-2024-5084)**. The version on our target is vulnerable.

---

## 3. Summary of Findings for the Linux Target

By combining the information from both FTP and WordPress enumeration, we have a clear picture of the target and multiple potential attack paths.

### Reconnaissance Summary
| Component | Information Gathered |
| :--- | :--- |
| **Operating System** | Ubuntu Linux |
| **Identified User** | `john` |
| **FTP Service (21)** | Anonymous login enabled, exposes `john`'s home directory. |
| **SSH Service (22)** | OpenSSH 8.9p1 running. |
| **Web Service (443)** | WordPress 6.7.2 with theme `twentytwentyfive` v1.0 and plugin `hash-form` v1.1.0. Domain is `cube-case.htb`.|

### Actionable Vulnerabilities & "Low-Hanging Fruits"

1.  **Potential Credentials:** The password `SuperSecurePass123` for the user `john` was found in `.bash_history`.
2.  **Exposed SSH Private Key:** An unencrypted `id_rsa` key for the user `john` was downloaded from the FTP server.
3.  **Exploitable Plugin (RCE):** The `hash-form` WordPress plugin is vulnerable to a known Remote Code Execution exploit (CVE-2024-5084).

With this information, we have multiple, high-confidence vectors to attempt exploitation.
