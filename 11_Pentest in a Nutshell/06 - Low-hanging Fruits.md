# 06 - Low-hanging Fruits


## 1. What are Low-Hanging Fruits?

**Low-hanging fruits** are the most immediate and accessible risks in an environment. Attackers target these first because they offer a high return on investmentâ€”quick wins with minimal effort.

*   **Goal:** To identify initial entry points that can lead to further exploitation.
*   **Examples:**
    *   Unpatched software with a well-known, public exploit.
    *   Services running with default or weak credentials.
    *   Publicly exposed services with insecure configurations (e.g., anonymous FTP access).
*   **Methodology:** This phase blends **Information Gathering** (researching a discovered service) and **Vulnerability Assessment** (analyzing its security). The key is to work with the information you see and avoid overthinking or "hallucinating" complex attack paths before checking for simple, obvious flaws.

---

## 2. Practical Example: Enumerating Targets

Let's analyze the `nmap` scan results from two hosts in the target network to identify potential low-hanging fruits.

### Target 1: `10.129.12.10` (Linux Host)
A targeted `nmap` scan reveals the following key services:

```shell
sudo nmap -p21,22,443 -sV -sC 10.129.12.10
```

| Port | Service | Nmap Finding | Potential Low-Hanging Fruit |
| :--- | :--- | :--- | :--- |
| **21/tcp** | **FTP** | `ProFTPD`, **Anonymous FTP login allowed**. A file named `WordPress_Blog_Setup_Update.txt` is visible. | **Anonymous FTP access is a classic misconfiguration.** The text file could contain sensitive information, credentials, or clues about the system's setup. The presence of the user `john` is also noted. |
| **22/tcp** | **SSH** | `OpenSSH 8.9p1 Ubuntu`. | SSH is generally secure, but this confirms the OS is Ubuntu Linux. The version could be checked for specific vulnerabilities. |
| **443/tcp**| **HTTPS**| Title: `Cube Case`. Server is running **WordPress 6.7.2**. The SSL certificate reveals the domain `cube-case.htb`. | An outdated or default **WordPress installation** is a major attack surface. It could be vulnerable to plugin exploits, theme vulnerabilities, or weak user passwords. |

#### Summary for Target 1:
*   **OS:** Ubuntu Linux
*   **Key Services:** FTP, SSH, WordPress
*   **Immediate Action Items:**
    1.  Log in to the FTP server anonymously and download the `WordPress_Blog_Setup_Update.txt` file.
    2.  Begin enumerating the WordPress site for vulnerabilities related to version 6.7.2, its plugins, and themes.

### Target 2: `10.129.12.20` (Windows Host)
A more comprehensive `nmap` scan reveals several services.

```shell
sudo nmap -p- -sV -sC 10.129.12.20 -T5 -Pn
```

| Port | Service | Nmap Finding | Potential Low-Hanging Fruit |
| :--- | :--- | :--- | :--- |
| **445/tcp** | **SMB** | `Windows Server 2019 Standard`. Hostname: `WIN01`, Workgroup: `HTBLAB`. **Message signing is disabled (dangerous)**. | SMB is a high-value target. Disabled message signing makes the host vulnerable to SMB Relay attacks. |
| **3389/tcp**| **RDP** | `Microsoft Terminal Services`. | RDP is a common entry point if weak credentials can be found or guessed. |
| **3000/tcp**| **HTTP** | `Golang net/http server`, Title: `Cube Case Gitea`. | **Gitea** is a self-hosted Git service. An **outdated version of Gitea** is a significant low-hanging fruit, as it likely has known public vulnerabilities (CVEs). Code repositories can also contain sensitive information like hardcoded credentials or API keys. |

#### Summary for Target 2:
*   **OS:** Windows Server 2019
*   **Key Services:** SMB, RDP, Gitea
*   **Immediate Action Items:**
    1.  Research the specific version of Gitea running on the server to find public exploits (CVEs).
    2.  Check the Gitea instance for any public repositories that might contain sensitive information.
    3.  Enumerate SMB for any accessible shares.

---

## 3. The Importance of Note-Taking

Throughout the scanning and analysis process, meticulous note-taking is essential.
*   **Document Commands:** Record the exact `nmap` commands you run.
*   **Log Findings:** For each host, create a structured summary of its OS, open ports, services, versions, and any potential vulnerabilities or interesting information discovered.
*   **Track Clues:** Write down small details like usernames (`john`), domain names (`cube-case.htb`), and file names. These seemingly minor clues are often critical for piecing together an attack path later on.
